"use strict";

//load here to avoid async stuff
let structureJSON = {
	"urlId": "home",
	"label": "Valentin Machado",
	"modelId": "casa",
	"child": [{
		"label": "Studies",
		"urlId": "studies",
		"modelId": "thinker",
		"child": [{
			"label": "High School",
			"child": [],
			"type": "html3d",
			"html": "J'ai effectué mon lycée, à Nîmes au <a rel=\"noopener noreferrer\"  target=\"_blank\" href = \"https://www.lyc-lamour-nimes.ac-montpellier.fr/\">lycée Phillipe Lamour</a>. J'ai choisi l'option science en seconde, et j'ai pris l'option spé maths en terminal parce que j'aime bien la science vous voyez"
		}, {
			"label": "CPGE",
			"child": [],
			"type": "html3d",
			"html": "Je me suis ensuite orienter en classe de MPSI parce les ciences patincoufin au lycée <a rel=\"noopener noreferrer\"  target=\"_blank\" href = \"https://www.lyc-daudet-nimes.ac-montpellier.fr/content/cpge\">lycée Alphonse Daudet</a>"
		}, {
			"label": "CPE Lyon",
			"child": [],
			"type": "link",
			"url": "https://www.cpe.fr/"
		}, {
			"label": "Queen's University",
			"child": [],
			"type": "div3d"
		}],
		"type": "div3d"
	}, {
		"type": "div3d",
		"label": "Professional experience",
		"urlId": "professional_exp",
		"modelId": "computer",
		"child": [{
			"type": "div3d",
			"label": "IHMTEK",
			"urlId": "ihmtek",
			"child": [{
				"type": "link",
				"label": "Website",
				"url": "https://www.ihmtek.com/",
				"child": []
			}, {
				"type": "link",
				"label": "Ludomuse",
				"url": "https://docs.google.com/presentation/d/e/2PACX-1vQBTJDzJ_ycIXlUt6RQOGRqZdib38s_Xn74M9MKl-cwDWc6RUDXhLwSf_OJYJjgIos1VSZI_spXbyEm/embed?start=false&loop=false&delayms=3000",
				"child": []
			}]
		}, {
			"type": "div3d",
			"label": "Wanadev",
			"urlId": "wanadev",
			"child": [{
				"type": "link",
				"label": "Website",
				"url": "https://www.wanadev.fr/",
				"child": []
			}, {
				"type": "html3d",
				"urlId": "popup_builder",
				"label": "Popup Builder",
				"html": "<iframe src=\"https://www.popup-house.com/fr/my-popup/\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen height=\"70%\"></iframe>J'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé sur ce projetJ'ai travaillé ",
				"child": []
			}, {
				"type": "div3d",
				"label": "R&D",
				"child": [{
					"type": "link",
					"label": "Internship",
					"url": "https://docs.google.com/presentation/d/e/2PACX-1vTo2-dyyrSwNW8yzhvimOaZyukHdWVXoGVgsnc4UovFDvVpIPU-E8vjGlnBfGjKnMEDHxP2ykJLSgWT/embed?start=false&loop=false&delayms=3000",
					"child": []
				}, {
					"type": "video",
					"urlId": "water_pp",
					"title": "Water post-process made with BABYLON JS",
					"label": "Water Post-process",
					"path": "./src/assets/video/water.mp4",
					"width": 480,
					"height": 480,
					"child": []
				}]
			}]
		}]
	}, {
		"type": "div3d",
		"label": "Personnal project",
		"urlId": "personnal_project",
		"modelId": "barrel",
		"child": [{
			"type": "div3d",
			"urlId": "programming",
			"label": "Programming",
			"modelId": "computer",
			"child": [{
					"type": "div3d",
					"label": "Souk",
					"urlId": "souk",
					"modelId": "diamond",
					"child": [{
						"type": "link",
						"label": "Play it!",
						"url": "./src/assets/build/souk/souk.html",
						"child": []
					}]
				}, {
					"type": "div3d",
					"label": "Le Demon",
					"urlId":"le_demon",
					"modelId": "pillar",
					"child": [{
						"type": "link",
						"label": "play game !",
						"url": "./src/assets/build/demon/index.html",
						"child": []
					}]
				}, {
					"type": "div3d",
					"label": "Portfolio 3D",
					"child": []
				}, {
					"type": "video",
					"urlId": "walls",
					"label": "Walls",
					"modelId": "wall",
					"path": "./src/assets/video/walls_trailer.mp4",
					"title": "Queen's University school project",
					"width": 640,
					"height": 352,
					"child": []
				}, {
					"type": "video",
					"urlId": "dungeon_trailer",
					"title": "Project made with GameMaker",
					"modelId": "chest",
					"label": "Dungeon Card",
					"path": "./src/assets/video/dungeoncard_compressed.mp4",
					"width": 640,
					"height": 352,
					"child": []
				}

			]
		}, {
			"type": "div3d",
			"label": "Music",
			"urlId": "music",
			"modelId": "speaker",
			"child": [{
				"type": "div3d",
				"label": "Steampong",
				"modelId": "gear",
				"child": [{
					"type": "html3d",
					"label": "Context",
					"html": "<a rel=\"noopener noreferrer\"  target=\"_blank\" href = \"https://globalgamejam.org/2014/games/steam-pong\">Steampong</a> is a game made at the Global Game Jam 2014. The team was composed of only 3 people : a programmer, an artist and myself as a sound designer. We worked together on the game design. The whole content has been produced within a 48h period including full graphics, 3 music themes and the whole game code.The game received positive feedbacks from the audience.",
					"child": []
				}, {
					"type": "video",
					"label": "Trailer",
					"path": "./src/assets/video/ggj2014-steam-pong.mp4",
					"title": "Trailer SteamPong",
					"width": 1280,
					"height": 720,
					"child": []
				}, {
					"type": "link",
					"label": "OST",
					"modelId": "radio",
					"url": "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/21336300&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true",
					"child": []
				}]
			}, {
				"type": "link",
				"label": "Ma Chandelle Verte",
				"modelId": "radio",
				"url": "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/users/524173593&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true",
				"child": []
			}, {
				"type": "html3d",
				"label": "Playlist",
				"urlId": "playlist_jailln_mache",
				"modelId": "radio",
				"html": "<img src = \"./src/assets/img/playlist.png\"> Les playlist du jailln et de la mache - Playlist on a particular theme or music genre. <a rel=\"noopener noreferrer\"  target=\"_blank\" href = \"https://vimeo.com/album/5527011\"> website</a> <br> <iframe src=\"https://player.vimeo.com/video/330845878\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/315117555\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/307960107\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/303532748\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/298485745\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/299649347\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe><iframe src=\"https://player.vimeo.com/video/298484622\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen class=\"html-video\"></iframe>",
				"child": []
			}, {
				"type": "link",
				"label": "Soundcloud",
				"urlId": "soundcloud",
				"modelId": "radio",
				"url": "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/users/26062108&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true",
				"child": []
			}]
		}]
	}, {
		"type": "html3d",
		"urlId": "cv",
		"label": "CV",
		"child": [],
		"html": "<embed src=\"./src/assets/pdf/CV.pdf\" width=\"100%\" height=\"100%\" />"
	}],
	"type": "div3d"
};

// let structureJSON = {
// 	"type": "div3d",
// 	"label": "Naïs Collet",
// 	"child": []
// }

window.wE3D = new WebExplorer3D({
	minDim: 50,
	modelData: [{
		id: "barrel",
		file: "barrel.obj"
	}, {
		id: "computer",
		file: "computer.obj"
	}, {
		id: "chest",
		file: "chest.obj"
	}, {
		id: "speaker",
		file: "speaker.obj"
	}, {
		id: "radio",
		file: "radio.obj"
	}, {
		id: "diamond",
		file: "diamond.obj"
	}, {
		id: "thinker",
		file: "thinker.obj"
	}, {
		id: "casa",
		file: "casa.obj"
	}, {
		id: "wall",
		file: "wall.obj"
	}, {
		id: "pillar",
		file: "pillar.obj"
	}, {
		id: "gear",
		file: "gear.obj"
	}]
});

try {
	console.info("%cInitialize app ...", "color:#0000FF;");

	//add a loading screen
	var loadingHtml = WebExplorerUtility.HtmlUtility.createLoadingScreen()
	var wE3DHtml = document.getElementById("webExplorer3D")
	wE3DHtml.appendChild(loadingHtml);

	//wait image of the loading screen to be load to begin to load app
	loadingHtml.image.addEventListener('load', function() {

		//load model 3d
		WebExplorerUtility.HtmlUtility.writeLoadingScreen("App loading...")
		wE3D.load()
			.then(function() {
				WebExplorerUtility.HtmlUtility.writeLoadingScreen("Model loading...")
				return WebExplorerUtility.ModelUtility.load();
			})
			.then(function() {
				WebExplorerUtility.HtmlUtility.writeLoadingScreen("Material loading...")
				return WebExplorerUtility.MaterialUtility.load();
			})
			.then(function() {

				wE3D.initialize(structureJSON);

				//remove loading screen
				wE3DHtml.removeChild(loadingHtml)

				console.info("%c... ok!", "color:#0000FF;");
			})
	});

} catch (e) {
	console.error(e);
}